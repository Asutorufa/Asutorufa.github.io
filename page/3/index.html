<!DOCTYPE html><html class="theme-next gemini use-motion" lang="en,ja,zh-Hans,default"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="theme-color" content="#FFF0F5"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css"><link href="/css/main.css" rel="stylesheet" type="text/css"><link rel="icon" type="image/png" sizes="16x16" href="/images/bighead.svg"><meta name="keywords" content="program"><link rel="alternate" href="/atom.xml" title="Asutorufaのブログ" type="application/atom+xml"><meta property="og:type" content="website"><meta property="og:title" content="Asutorufaのブログ"><meta property="og:url" content="https://asutorufa.com/page/3/index.html"><meta property="og:site_name" content="Asutorufaのブログ"><meta property="og:locale" content="en_US"><meta property="article:author" content="Asutorufa"><meta name="twitter:card" content="summary"><script type="text/javascript" id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"",scheme:"Gemini",version:"5.1.3",sidebar:{position:"right",display:"post",offset:12,b2t:!0,scrollpercent:!0,onmobile:!0},fancybox:!1,tabs:!0,motion:{enable:!0,async:!0,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},algolia:{applicationID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},mermaid:{enable:!0,theme:{light:"default",dark:"dark"}}}</script><link rel="canonical" href="https://asutorufa.com/page/3/"><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8681435945442113" crossorigin="anonymous"></script><title>Asutorufaのブログ - こんにちは</title><script async src="https://www.googletagmanager.com/gtag/js?id=G-JN3GB41L9H"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-JN3GB41L9H")</script><meta name="generator" content="Hexo 7.3.0"></head><body itemscope itemtype="http://schema.org/WebPage" lang="en"><div class="container sidebar-position-right page-home"><div class="headband"></div><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">Asutorufaのブログ</span><span class="logo-line-after"><i></i></span></a></div><h1 class="site-subtitle" itemprop="description">こんにちは</h1></div><div class="site-nav-toggle"> <button><span class="btn-bar"></span><span class="btn-bar"></span><span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br> Home</a></li><li class="menu-item menu-item-tags"><a href="/tags" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i><br> Tags</a></li><li class="menu-item menu-item-categories"><a href="/categories" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i><br> Categories</a></li><li class="menu-item menu-item-archives"><a href="/archives" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br> Archives</a></li><li class="menu-item menu-item-about"><a href="/about" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i><br> About</a></li><li class="menu-item menu-item-friends"><a href="/friends" rel="section"><i class="menu-item-icon fa fa-fw fa-users"></i><br> Friends</a></li><li class="menu-item menu-item-search"><a href="javascript:;" class="popup-trigger"><i class="menu-item-icon fa fa-search fa-fw"></i><br> Search</a></li></ul><div class="site-search"><div class="popup search-popup local-search-popup"><div class="local-search-header clearfix"><span class="search-icon"><i class="fa fa-search"></i></span><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span><div class="local-search-input-wrapper"> <input autocomplete="off" placeholder="Searching..." spellcheck="false" type="text" id="local-search-input"></div></div><div id="local-search-result"></div></div></div></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><section id="posts" class="posts-expand"><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://asutorufa.com/posts/afc6d6dd/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content=""><meta itemprop="description" content=""><meta itemprop="image" content="/images/bighead.svg"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Asutorufaのブログ"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"> <a class="post-title-link" href="/posts/afc6d6dd/" itemprop="url">Hyperledger Fabric组织更换证书</a></h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">Posted on</span> <time title="Post created" itemprop="dateCreated datePublished" datetime="2021-01-24T17:34:58+00:00">2021-01-24</time> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-calendar-check-o"></i></span> <span class="post-meta-item-text">Post modified&#58;</span> <time title="Post modified" itemprop="dateModified" datetime="2021-01-24T17:34:58+00:00">2021-01-24</time></span> <span class="post-category"><span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Hyperledger-fabric/" itemprop="url" rel="index"><span itemprop="name">Hyperledger fabric</span></a></span></span></div></header><div class="post-body" itemprop="articleBody"><h2 id="前言">前言</h2><p>最近一直在研究关于如何给一个fabric的组织更换一个新的证书, 包括所有加入的通道, 所有peer和orderer.<br> 用了很多看似完美的方法却多次测试失败, 最后总算找到一种方法.</p><pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
    <span class="token property">"channel_group"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
        <span class="token property">"groups"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
            <span class="token property">"Application"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
                <span class="token property">"groups"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
                    <span class="token property">"Org1MSP"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
                        <span class="token property">"groups"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> 
                        <span class="token property">"mod_policy"</span><span class="token operator">:</span> <span class="token string">"Admins"</span><span class="token punctuation">,</span> 
                        <span class="token property">"values"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
                            <span class="token property">"MSP"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
                            <span class="token punctuation">&#125;</span>
                        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> 
                        <span class="token property">"version"</span><span class="token operator">:</span> <span class="token string">"0"</span>
                    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> 
                    <span class="token property">"Org2MSP"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
                        <span class="token property">"groups"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> 
                        <span class="token property">"mod_policy"</span><span class="token operator">:</span> <span class="token string">"Admins"</span><span class="token punctuation">,</span> 
                        <span class="token property">"values"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
                            <span class="token property">"MSP"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
                            <span class="token punctuation">&#125;</span>
                        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> 
                        <span class="token property">"version"</span><span class="token operator">:</span> <span class="token string">"0"</span>
                    <span class="token punctuation">&#125;</span>
                <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> 
                <span class="token property">"version"</span><span class="token operator">:</span> <span class="token string">"1"</span>
            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> 
            <span class="token property">"Orderer"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
                <span class="token property">"groups"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
                    <span class="token property">"OrdererOrg"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
                        <span class="token property">"groups"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> 
                        <span class="token property">"values"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
                            <span class="token property">"MSP"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
                            <span class="token punctuation">&#125;</span>
                        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> 
                        <span class="token property">"version"</span><span class="token operator">:</span> <span class="token string">"0"</span>
                    <span class="token punctuation">&#125;</span>
                <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> 
                <span class="token property">"values"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
                    <span class="token property">"ConsensusType"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
                        <span class="token property">"mod_policy"</span><span class="token operator">:</span> <span class="token string">"Admins"</span><span class="token punctuation">,</span> 
                        <span class="token property">"value"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
                            <span class="token property">"metadata"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
                                <span class="token property">"consenters"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                                    <span class="token punctuation">&#123;</span>
                                        <span class="token property">"client_tls_cert"</span><span class="token operator">:</span> <span class="token string">"=="</span><span class="token punctuation">,</span> 
                                        <span class="token property">"host"</span><span class="token operator">:</span> <span class="token string">"orderer.example.com"</span><span class="token punctuation">,</span> 
                                        <span class="token property">"port"</span><span class="token operator">:</span> <span class="token number">7050</span><span class="token punctuation">,</span> 
                                        <span class="token property">"server_tls_cert"</span><span class="token operator">:</span> <span class="token string">"=="</span>
                                    <span class="token punctuation">&#125;</span>
                                <span class="token punctuation">]</span><span class="token punctuation">,</span> 
                                <span class="token property">"options"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
                                    <span class="token property">"election_tick"</span><span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span> 
                                    <span class="token property">"heartbeat_tick"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> 
                                    <span class="token property">"max_inflight_blocks"</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span> 
                                    <span class="token property">"snapshot_interval_size"</span><span class="token operator">:</span> <span class="token number">16777216</span><span class="token punctuation">,</span> 
                                    <span class="token property">"tick_interval"</span><span class="token operator">:</span> <span class="token string">"500ms"</span>
                                <span class="token punctuation">&#125;</span>
                            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> 
                            <span class="token property">"state"</span><span class="token operator">:</span> <span class="token string">"STATE_NORMAL"</span><span class="token punctuation">,</span> 
                            <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"etcdraft"</span>
                        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> 
                        <span class="token property">"version"</span><span class="token operator">:</span> <span class="token string">"0"</span>
                    <span class="token punctuation">&#125;</span>
                <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> 
                <span class="token property">"version"</span><span class="token operator">:</span> <span class="token string">"0"</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> 
        <span class="token property">"sequence"</span><span class="token operator">:</span> <span class="token string">"2"</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>一个通道配置块类似上面这种,为了看的清楚有些内容我删了, 更换证书我们需要保证application及orderer的MSP是相同的, 否则更新配置块是不会成功的, 且我们得保证当前组织的raft节点的证书也要全部更换掉.</p><h2 id="失败过程">失败过程</h2><div class="post-button text-center"> <a class="btn" href="/posts/afc6d6dd/#more" rel="contents">Read more &raquo;</a></div></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://asutorufa.com/posts/3a1d136/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content=""><meta itemprop="description" content=""><meta itemprop="image" content="/images/bighead.svg"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Asutorufaのブログ"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"> <a class="post-title-link" href="/posts/3a1d136/" itemprop="url">使用GVT-g显卡虚拟化</a></h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">Posted on</span> <time title="Post created" itemprop="dateCreated datePublished" datetime="2021-01-17T20:53:29+00:00">2021-01-17</time> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-calendar-check-o"></i></span> <span class="post-meta-item-text">Post modified&#58;</span> <time title="Post modified" itemprop="dateModified" datetime="2021-01-17T20:53:29+00:00">2021-01-17</time></span> <span class="post-category"><span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a></span></span></div></header><div class="post-body" itemprop="articleBody"><h2 id="为内核添加参数">为内核添加参数</h2><p>比如<code>grub</code>在<code>/etc/default/grub</code>的<code>GRUB_CMDLINE_LINUX_DEFAULT=</code>中添加</p><pre class="language-ini" data-language="ini"><code class="language-ini"><span class="token key attr-name">intel_iommu</span><span class="token punctuation">=</span><span class="token value attr-value">on i915.enable_gvt=1 i915.enable_guc=0</span></code></pre><h2 id="启用modules">启用modules</h2><p>在<code>/etc/mkinitcpio.conf</code>的MODULES=()`中添加:</p><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini"><span class="token comment"># linux 5.14后，arch的linux内核模块已经不会勾选vfio-mdev，自测不影响gvt-g</span>
kvmgt vfio vfio-iommu-type1s<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>然后运行,我用的zen内核所以是linux-zen,默认内核是linux</p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> mkinitcpio <span class="token parameter variable">-p</span> linux-zen</code></pre><p>重启计算机</p><p>查看<code>/sys/devices/pci0000:00/0000:00:02.0/mdev_supported_types</code>可以看见类似如下的目录</p><div class="post-button text-center"> <a class="btn" href="/posts/3a1d136/#more" rel="contents">Read more &raquo;</a></div></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://asutorufa.com/posts/7d547224/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content=""><meta itemprop="description" content=""><meta itemprop="image" content="/images/bighead.svg"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Asutorufaのブログ"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"> <a class="post-title-link" href="/posts/7d547224/" itemprop="url">gpg使用</a></h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">Posted on</span> <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-10-02T14:00:01+00:00">2020-10-02</time> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-calendar-check-o"></i></span> <span class="post-meta-item-text">Post modified&#58;</span> <time title="Post modified" itemprop="dateModified" datetime="2020-10-02T14:00:01+00:00">2020-10-02</time></span> <span class="post-category"><span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/linux/" itemprop="url" rel="index"><span itemprop="name">linux</span></a></span></span></div></header><div class="post-body" itemprop="articleBody"><p>生成一个密钥</p><pre class="language-bash" data-language="bash"><code class="language-bash">gpg --full-gen-key</code></pre><p>之后会选择加密方式, 有效期, 用户名及邮箱, 密码, 按自己需求填就行了.</p><p>创建一个子密钥</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">gpg --edit-key <span class="token punctuation">[</span>key hash<span class="token punctuation">]</span>

gpg<span class="token operator">></span> addkey
<span class="token comment">#只有与前面是相同的, 按需求选择.</span>

gpg<span class="token operator">></span> save
<span class="token comment"># 保存</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>导出密钥</p><pre class="language-bash" data-language="bash"><code class="language-bash">gpg <span class="token parameter variable">-o</span> /path/gpg_key --export-secret-keys <span class="token punctuation">[</span>key hash<span class="token punctuation">]</span></code></pre><p>导出子密钥</p><pre class="language-bash" data-language="bash"><code class="language-bash">gpg <span class="token parameter variable">-o</span> /path/gpg_key.sub --export-secret-subkeys <span class="token punctuation">[</span>key hash<span class="token punctuation">]</span></code></pre><p>导出吊销证书</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">gpg --generate-revocation <span class="token punctuation">[</span>key hash<span class="token punctuation">]</span>
<span class="token comment"># 输出是文本内容, 复制保存下来就行了</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><div class="post-button text-center"> <a class="btn" href="/posts/7d547224/#more" rel="contents">Read more &raquo;</a></div></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://asutorufa.com/posts/931c13a4/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content=""><meta itemprop="description" content=""><meta itemprop="image" content="/images/bighead.svg"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Asutorufaのブログ"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"> <a class="post-title-link" href="/posts/931c13a4/" itemprop="url">GeoIP mmdb format</a></h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">Posted on</span> <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-07-27T22:15:17+00:00">2020-07-27</time> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-calendar-check-o"></i></span> <span class="post-meta-item-text">Post modified&#58;</span> <time title="Post modified" itemprop="dateModified" datetime="2020-07-27T22:15:17+00:00">2020-07-27</time></span> <span class="post-category"><span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Network/" itemprop="url" rel="index"><span itemprop="name">Network</span></a></span></span></div></header><div class="post-body" itemprop="articleBody"><p>complete document <a target="_blank" rel="noopener" href="https://maxmind.github.io/MaxMind-DB/">MaxMind DB File Format SpecificationDescription</a></p><p>here is only how convert trie tree to array</p><pre class="line-numbers language-markdown" data-language="markdown"><code class="language-markdown">0100, 1011 -> trie

<span class="token code keyword">              root
               |
         +-----+------+
        /              \
       0                1
     /   \             /  \</span>
   null   1           0   null
         / \        /   \
        0 null     null   1
       / \               / \
       0 null         null  1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>trie -&gt; array<br> left is 0, right is 1<br> value is index of array</p><div class="post-button text-center"> <a class="btn" href="/posts/931c13a4/#more" rel="contents">Read more &raquo;</a></div></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://asutorufa.com/posts/4b39445f/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content=""><meta itemprop="description" content=""><meta itemprop="image" content="/images/bighead.svg"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Asutorufaのブログ"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"> <a class="post-title-link" href="/posts/4b39445f/" itemprop="url">DNS over HTTPS</a></h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">Posted on</span> <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-06-23T00:30:08+00:00">2020-06-23</time> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-calendar-check-o"></i></span> <span class="post-meta-item-text">Post modified&#58;</span> <time title="Post modified" itemprop="dateModified" datetime="2020-06-23T00:30:08+00:00">2020-06-23</time></span> <span class="post-category"><span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Network/" itemprop="url" rel="index"><span itemprop="name">Network</span></a></span></span></div></header><div class="post-body" itemprop="articleBody"><p>这个DNS系列现在有以下几篇文章<br> <a href="/posts/f05986bf/">DNS</a> <a href="/posts/668530ca/">EDNS</a> <a href="/posts/1751943e/">DNSSEC</a> <a href="/posts/4b39445f/">DNS over HTTPS</a> 完整代码请看<a target="_blank" rel="noopener" href="https://github.com/Asutorufa/yuhaiin/tree/master/net/dns">DNS</a></p><hr><p>DOH就比较简单了,因为DOH使用的请求数据和应答数据均为之前的DNS协议格式,包括DNS,EDNS,DNSSEC…当然是否支持EDNS,DNSSEC需要看DNS服务器的支持情况<br> DOH的最主要的区别是把DNS使用的UDP,换成了HTTPS,这样就能防止DNS污染了,而且可以使用DNSSEC加上ESNI来防止证书劫持,DOH的协议在<a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc8484">rfc8484</a>中有定义<br> DOH主要有两种方式HTTP的GET请求和POST的请求</p><h2 id="GET">GET</h2><p>GET请求需要使用BASE64对请求的字节数据进行序列化,然后作为参数传递,获取到的数据使用我们之前的解析进行解析就行了</p><pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">func</span> <span class="token function">get</span><span class="token punctuation">(</span>dReq <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">,</span> server <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>body <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
 query <span class="token operator">:=</span> strings<span class="token punctuation">.</span><span class="token function">Replace</span><span class="token punctuation">(</span>base64<span class="token punctuation">.</span>URLEncoding<span class="token punctuation">.</span><span class="token function">EncodeToString</span><span class="token punctuation">(</span>dReq<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"="</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
 urls <span class="token operator">:=</span> <span class="token string">"https://"</span> <span class="token operator">+</span> server <span class="token operator">+</span> <span class="token string">"/dns-query?dns="</span> <span class="token operator">+</span> query
 res<span class="token punctuation">,</span> err <span class="token operator">:=</span> http<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span>urls<span class="token punctuation">)</span>
 <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> err
 <span class="token punctuation">&#125;</span>
 <span class="token keyword">defer</span> res<span class="token punctuation">.</span>Body<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
 body<span class="token punctuation">,</span> err <span class="token operator">=</span> ioutil<span class="token punctuation">.</span><span class="token function">ReadAll</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>Body<span class="token punctuation">)</span>
 <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> err
 <span class="token punctuation">&#125;</span>
 <span class="token keyword">return</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="POST">POST</h2><p>POST并不需要进行序列化,直接把原始请求数据作为body就行了</p><div class="post-button text-center"> <a class="btn" href="/posts/4b39445f/#more" rel="contents">Read more &raquo;</a></div></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://asutorufa.com/posts/1751943e/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content=""><meta itemprop="description" content=""><meta itemprop="image" content="/images/bighead.svg"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Asutorufaのブログ"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"> <a class="post-title-link" href="/posts/1751943e/" itemprop="url">DNSSEC</a></h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">Posted on</span> <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-06-23T00:21:33+00:00">2020-06-23</time> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-calendar-check-o"></i></span> <span class="post-meta-item-text">Post modified&#58;</span> <time title="Post modified" itemprop="dateModified" datetime="2020-06-23T00:21:33+00:00">2020-06-23</time></span> <span class="post-category"><span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Network/" itemprop="url" rel="index"><span itemprop="name">Network</span></a></span></span></div></header><div class="post-body" itemprop="articleBody"><p>这个DNS系列现在有以下几篇文章<br> <a href="/posts/f05986bf/">DNS</a> <a href="/posts/668530ca/">EDNS</a> <a href="/posts/1751943e/">DNSSEC</a> <a href="/posts/4b39445f/">DNS over HTTPS</a> 完整代码请看<a target="_blank" rel="noopener" href="https://github.com/Asutorufa/yuhaiin/tree/master/net/dns">DNS</a></p><hr><p>注意: 这里我只完成了请求字段,主要原因是因为我学习这些DNS协议是为了找到防止DNS污染的方法,而DNSSEC并不能,而且应答头比较复杂,可能还要了解ssl和tls的知识,所以这里我没有完成代码,想了解的请看<a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc3225">protocol change</a> <a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc4034">rfc4034</a> <a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc4035">rfc4035</a> <a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc4034#appendix-A.1">Algorithm</a></p><p>DNSSEC也是使用了EDNS,而且只需要改一个字段,就是之前提到Z,具体协议请看</p><pre class="line-numbers language-markdown" data-language="markdown"><code class="language-markdown">          +0 (MSB)                +1 (LSB)
   +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
0: |   EXTENDED-RCODE      |       VERSION         |
   +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
2: |DO|                    Z                       |
   +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>完成请求头</p><div class="post-button text-center"> <a class="btn" href="/posts/1751943e/#more" rel="contents">Read more &raquo;</a></div></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://asutorufa.com/posts/668530ca/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content=""><meta itemprop="description" content=""><meta itemprop="image" content="/images/bighead.svg"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Asutorufaのブログ"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"> <a class="post-title-link" href="/posts/668530ca/" itemprop="url">EDNS</a></h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">Posted on</span> <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-06-22T23:09:49+00:00">2020-06-22</time> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-calendar-check-o"></i></span> <span class="post-meta-item-text">Post modified&#58;</span> <time title="Post modified" itemprop="dateModified" datetime="2020-06-22T23:09:49+00:00">2020-06-22</time></span> <span class="post-category"><span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Network/" itemprop="url" rel="index"><span itemprop="name">Network</span></a></span></span></div></header><div class="post-body" itemprop="articleBody"><p>这个DNS系列现在有以下几篇文章<br> <a href="/posts/f05986bf/">DNS</a> <a href="/posts/668530ca/">EDNS</a> <a href="/posts/1751943e/">DNSSEC</a> <a href="/posts/4b39445f/">DNS over HTTPS</a> 完整代码请看<a target="_blank" rel="noopener" href="https://github.com/Asutorufa/yuhaiin/tree/master/net/dns">DNS</a></p><h2 id="EDNS">EDNS</h2><p>上一篇我们写了DNS,EDNS就是DNS的功能扩充.<br> 上一篇的DNS里头部有ARCOUNT的计数,EDNS就包含在那个里面,EDNS发送的请求在请求头之后的Additional中,应答在Answer和Authoritative之后,我们可看以下图,跟清晰了吧</p><pre class="line-numbers language-markdown" data-language="markdown"><code class="language-markdown">+---------------------+
|        Header       |
+---------------------+
|       Question      | the question for the name server
+---------------------+
|        Answer       | RRs answering the question
+---------------------+
|      Authority      | RRs pointing toward an authority
+---------------------+
|      Additional     | RRs holding additional information
+---------------------+<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="协议格式">协议格式</h2><p>具体协议内容请看<a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc2671">rfc2671</a>,<a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc7871">rfc7871</a></p><div class="post-button text-center"> <a class="btn" href="/posts/668530ca/#more" rel="contents">Read more &raquo;</a></div></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://asutorufa.com/posts/34615c2d/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content=""><meta itemprop="description" content=""><meta itemprop="image" content="/images/bighead.svg"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Asutorufaのブログ"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"> <a class="post-title-link" href="/posts/34615c2d/" itemprop="url">HP Laptop linux 下intel&amd双显卡</a></h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">Posted on</span> <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-06-05T15:12:33+00:00">2020-06-05</time> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-calendar-check-o"></i></span> <span class="post-meta-item-text">Post modified&#58;</span> <time title="Post modified" itemprop="dateModified" datetime="2020-06-05T15:12:33+00:00">2020-06-05</time></span> <span class="post-category"><span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/linux/" itemprop="url" rel="index"><span itemprop="name">linux</span></a></span></span></div></header><div class="post-body" itemprop="articleBody"><p>查看<code>双显卡</code>切换情况，正常情况下如果没有在用独显应该显示是<code>DynOff</code>，但是我这里即使是不开桌面也是<code>DynPwr</code></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span> ~ <span class="token punctuation">]</span> <span class="token function">cat</span> /sys/kernel/debug/vgaswitcheroo/switch
<span class="token number">0</span>:DIS-Audio: :DynPwr:0000:01:00.1
<span class="token number">1</span>:IGD:+:Pwr:0000:00:02.0
<span class="token number">2</span>:DIS: :DynPwr:0000:01:00.0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>查看<code>dmesg</code>找到</p><pre class="line-numbers language-log" data-language="log"><code class="language-log"><span class="token punctuation">[</span>    <span class="token number">3.495606</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>drm<span class="token punctuation">]</span> amdgpu kernel modesetting enabled<span class="token punctuation">.</span>
<span class="token punctuation">[</span>    <span class="token number">3.495628</span><span class="token punctuation">]</span> <span class="token property">vga_switcheroo:</span> detected switching method \_SB_<span class="token punctuation">.</span>PCI0<span class="token punctuation">.</span>GFX0<span class="token punctuation">.</span>ATPX handle
<span class="token punctuation">[</span>    <span class="token number">3.495741</span><span class="token punctuation">]</span> ATPX version <span class="token number">1</span><span class="token punctuation">,</span> functions <span class="token number">0x00000033</span>
<span class="token punctuation">[</span>    <span class="token number">3.495873</span><span class="token punctuation">]</span> ATPX Hybrid Graphics<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>找到了调用的方法，网上搜了一圈都没有使用方法，然后使用<code>acpi_call</code>尝试了几个参数，最后找到</p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token string">"\_SB_.PCI0.GFX0.ATPX 2 0"</span> <span class="token operator">></span>  /proc/acpi/call</code></pre><p>嗯，确实有用，但是实在是太暴力了，直接把整个显卡移除，可以看一下日志</p><div class="post-button text-center"> <a class="btn" href="/posts/34615c2d/#more" rel="contents">Read more &raquo;</a></div></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://asutorufa.com/posts/f05986bf/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content=""><meta itemprop="description" content=""><meta itemprop="image" content="/images/bighead.svg"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Asutorufaのブログ"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"> <a class="post-title-link" href="/posts/f05986bf/" itemprop="url">DNS客户端协议详解</a></h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">Posted on</span> <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-05-31T18:44:37+00:00">2020-05-31</time> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-calendar-check-o"></i></span> <span class="post-meta-item-text">Post modified&#58;</span> <time title="Post modified" itemprop="dateModified" datetime="2020-05-31T18:44:37+00:00">2020-05-31</time></span> <span class="post-category"><span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Network/" itemprop="url" rel="index"><span itemprop="name">Network</span></a></span></span></div></header><div class="post-body" itemprop="articleBody"><p>这个DNS系列现在有以下几篇文章<br> <a href="/posts/f05986bf/">DNS</a> <a href="/posts/668530ca/">EDNS</a> <a href="/posts/1751943e/">DNSSEC</a> <a href="/posts/4b39445f/">DNS over HTTPS</a> 完整代码请看<a target="_blank" rel="noopener" href="https://github.com/Asutorufa/yuhaiin/tree/master/net/dns">DNS</a></p><h2 id="DNS-Header">DNS Header</h2><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">                                1  1  1  1  1  1
  0  1  2  3  4  5  6  7  8  9  0  1  2  3  4  5
+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
|                      ID                       |
+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
|QR|   Opcode  |AA|TC|RD|RA|   Z    |   RCODE   |
+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
|                    QDCOUNT                    |
+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
|                    ANCOUNT                    |
+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
|                    NSCOUNT                    |
+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
|                    ARCOUNT                    |
+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>header在dns请求和应答中相同的,查询中有Query Section,应答中有answer section.</p><ul><li>ID: 2字节,应答中也有ID,可以用来判断是否为我们请求的应答</li><li>QR：1bit,请求时为0,应答时为1</li><li>Opcode：4bit 通常值为0（标准查询），其他值为1（反向查询）和2（服务器状态请求）,[3,15]保留值</li><li>AA：1bit authoritative answer,在应答中才有效</li><li>TC：1bit 表示可截断</li><li>RD：1bit 期望使用递归查询</li><li>RA：1bit 在应答中返回,返回服务器是否支持递归查询</li><li>Z： Reserved for future use.</li><li>RCODE：4bit,应答码,代表返回的状态<ul><li>0 No Error</li><li>1 Format error 格式错误</li><li>2 Server failure 服务器失败</li><li>3 Name Error 查询域名错误</li><li>4 Not Implemented 未实现的查询方式</li><li>5 Refused 拒绝</li><li>6-15 Reserved for future use.<div class="post-button text-center"> <a class="btn" href="/posts/f05986bf/#more" rel="contents">Read more &raquo;</a></div></li></ul></li></ul></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://asutorufa.com/posts/f87fc9f0/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content=""><meta itemprop="description" content=""><meta itemprop="image" content="/images/bighead.svg"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Asutorufaのブログ"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"> <a class="post-title-link" href="/posts/f87fc9f0/" itemprop="url">翻译-C程序员所应该知道的内存</a></h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">Posted on</span> <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-05-04T00:26:24+00:00">2020-05-04</time> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-calendar-check-o"></i></span> <span class="post-meta-item-text">Post modified&#58;</span> <time title="Post modified" itemprop="dateModified" datetime="2020-05-04T00:26:24+00:00">2020-05-04</time></span> <span class="post-category"><span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Program/" itemprop="url" rel="index"><span itemprop="name">Program</span></a></span></span></div></header><div class="post-body" itemprop="articleBody"><blockquote><p>原文章 <a target="_blank" rel="noopener" href="https://marek.vavrusa.com/memory/#mmap-fun">What a C programmer should know about memory</a><br> 提示: <strong>本篇文章的图片都是直接使用原文中的图片的地址,如果无法显示,请挂代理</strong></p></blockquote><hr><p>2007年,Ulrich Drepper写了一篇&quot;<a target="_blank" rel="noopener" href="http://www.akkadia.org/drepper/cpumemory.pdf">每个程序员都应该知道的内存</a>&quot;.是的,虽然这篇文章又细又长,但做到了它所应做到的.很多年后,虚拟内存的概念对于很多人来说仍然难以琢磨,仿佛是某种魔法.我无法抗拒的引用一下.很多年后甚至原始文章的有效性也被<a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/8126311/what-every-programmer-should-know-about-memory">质疑</a>,到底发生了什么事?</p><blockquote><p>北桥,这是什么东西?那不是巷战.</p></blockquote><p>我尝试从&quot;学习锁的基本原理&quot;去传达实用的一面(比如:你能做什么)和更多有趣的东西.可以看待这是一个胶水在原始文章和你每天使用的东西之间.例子将使用linux上的C99,但是更多主题将是普遍的.<br> 编辑: 虽然我对Windows不了解,但我很乐意联系文章去解释.我会尽全力去提起什么函数是平台特有的,但是再一次我只是一个人.如果你发现出入,请让我知道.<br> 事不宜迟，倒一杯咖啡，让我们开始吧。</p><p>译者注:</p><pre class="line-numbers language-markdown" data-language="markdown"><code class="language-markdown">worth one's salt:
    good or competent at the job or profession specified.
    ig:"any astrologer worth her salt would have predicted this"

what gives?
    是在英语对话中常用的一句口语
    通常用它的时候只有两层意思
    一个是What's happening?发生了什么事？
    另一个是What is the news?有什么消息？

the practical side
    实用的一面<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="理解虚拟内存-复杂且神秘">理解虚拟内存 - 复杂且神秘</h2><p>除非你要处理一些嵌入系统或内核空间的代码,否则你应该在保护模式下进行.这太棒了,你的程序一定拥有它自己的[虚拟]地址空间.“虚拟&quot;在这里很重要.这意味着,除了其他事情外,你不会被可使用的内存限制,但是也无权获得任何.为了使用这些空间,你不得向操作系统要一些真东西来作后援,这被叫做映射.后援可能是物理内存,也可能是持久性存储.前者也被叫做&quot;匿名映射”.但是,稍安勿躁.</p><div class="post-button text-center"> <a class="btn" href="/posts/f87fc9f0/#more" rel="contents">Read more &raquo;</a></div></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article></section><nav class="pagination"><a class="extend prev" rel="prev" href="/page/2/"><i class="fa fa-angle-left" aria-label="accessibility.prev_page"></i></a> <a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><a class="extend next" rel="next" href="/page/4/"><i class="fa fa-angle-right" aria-label="accessibility.next_page"></i></a></nav></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span><span class="sidebar-toggle-line sidebar-toggle-line-middle"></span><span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div id="sidebar-dimmer"></div><div class="sidebar-inner"><section class="site-overview-wrap sidebar-panel sidebar-panel-active"><div class="site-overview"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" src="/images/bighead.svg" alt=""><p class="site-author-name" itemprop="name"></p><p class="site-description motion-element" itemprop="description"></p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"> <a href="/archives"><span class="site-state-item-count">68</span> <span class="site-state-item-name">posts</span></a></div><div class="site-state-item site-state-categories"> <a href="/categories"><span class="site-state-item-count">23</span> <span class="site-state-item-name">categories</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags"><span class="site-state-item-count">85</span> <span class="site-state-item-name">tags</span></a></div></nav><div class="feed-link motion-element"><a href="/atom.xml" rel="alternate"><i class="fa fa-rss"></i> RSS</a></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/Asutorufa" target="_blank" title="GitHub"><i class="fa fa-fw fa-github"></i> GitHub</a></span><span class="links-of-author-item"><a href="/email/" target="_blank" title="E-Mail"><i class="fa fa-fw fa-envelope"></i> E-Mail</a></span></div></div></section><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span id="scrollpercent"><span>0</span>%</span></div><div class="for-blur"></div></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><div class="copyright">&copy; <span itemprop="copyrightYear">2025</span><span class="with-love"><i class="fa fa-user"></i></span> <span class="author" itemprop="copyrightHolder">Asutorufa</span></div></div></footer></div><script type="text/javascript">"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script><script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script><script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script><script type="text/javascript" src="/js/src/utils.js"></script><script type="text/javascript" src="/js/src/motion.js"></script><script type="text/javascript" src="/js/src/affix.js"></script><script type="text/javascript" src="/js/src/schemes/pisces.js"></script><script type="text/javascript" src="/js/src/bootstrap.js"></script><script type="text/javascript" src="/js/src/local-search.js"></script><script>localSearch("search.xml","/","1","auto")</script><link rel="stylesheet" href="/lib/katex/katex.min.css"><script type="text/javascript" src="/js/src/js.cookie.js"></script><script type="text/javascript" src="/js/src/scroll-cookie.js"></script><script type="text/javascript" src="/lib/mermaid/mermaid.min.js"></script><script type="text/javascript" src="/js/src/mermaid.js"></script><script type="text/javascript" src="/js/src/custom.js"></script></body></html>